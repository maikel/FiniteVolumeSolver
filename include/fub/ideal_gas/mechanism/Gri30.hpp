// Copyright (c) 2018 Maikel Nadolski
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.

#ifndef FUB_EULER_SOLVER_MECHANISM_GRI30_HPP
#define FUB_EULER_SOLVER_MECHANISM_GRI30_HPP

#include "fub/core/assert.hpp"
#include "fub/core/span.hpp"
#include "fub/ideal_gas/FlameMasterReactor.hpp"

#include <string>
#include <vector>

namespace fub {
namespace ideal_gas {
/// \ingroup Euler
struct Gri30 : public FlameMasterMechanism {
  typedef enum SpeciesLabel {

    /* Computed species s.. */
    /* Steady-state species ss.. */
    sAR = 0,
    sO = 1,
    sO2 = 2,
    sH = 3,
    sOH = 4,
    sH2 = 5,
    sHO2 = 6,
    sH2O2 = 7,
    sCH = 8,
    sCO = 9,
    s3XCH2 = 10,
    sHCO = 11,
    s1XCH2 = 12,
    sCH3 = 13,
    sCH2O = 14,
    sCH4 = 15,
    sCO2 = 16,
    sCH2OH = 17,
    sCH3O = 18,
    sCH3OH = 19,
    sC2H = 20,
    sC2H2 = 21,
    sHCCO = 22,
    sC2H3 = 23,
    sCH2CO = 24,
    sC2H4 = 25,
    sC2H5 = 26,
    sC2H6 = 27,
    sH2O = 28,
    sN2 = 29,
    sC = 30,
    sHCCOH = 31,
    sN = 32,
    sNO = 33,
    sN2O = 34,
    sNO2 = 35,
    sNH = 36,
    sHNO = 37,
    sNH2 = 38,
    sNNH = 39,
    sCN = 40,
    sNCO = 41,
    sHCN = 42,
    sHOCN = 43,
    sHNCO = 44,
    sH2CN = 45,
    sHCNN = 46,
    sHCNO = 47,
    sNH3 = 48,
    sCH2CHO = 49,
    sCH3CHO = 50,
    sC3H8 = 51,
    sC3H7 = 52,
    sEnd
  } SpeciesLabel;

  typedef enum ReactionLabel {
    /* Reactions */
    r1f = 0,
    r1b = 1,
    r2f = 2,
    r2b = 3,
    r3f = 4,
    r3b = 5,
    r4f = 6,
    r4b = 7,
    r5f = 8,
    r5b = 9,
    r6f = 10,
    r6b = 11,
    r7f = 12,
    r7b = 13,
    r8f = 14,
    r8b = 15,
    r9f = 16,
    r9b = 17,
    r10f = 18,
    r10b = 19,
    r11f = 20,
    r11b = 21,
    r12f = 22,
    r12b = 23,
    r13f = 24,
    r13b = 25,
    r14f = 26,
    r14b = 27,
    r15f = 28,
    r15b = 29,
    r16f = 30,
    r16b = 31,
    r17f = 32,
    r17b = 33,
    r18f = 34,
    r18b = 35,
    r19f = 36,
    r19b = 37,
    r20f = 38,
    r20b = 39,
    r21f = 40,
    r21b = 41,
    r22f = 42,
    r22b = 43,
    r23f = 44,
    r23b = 45,
    r24f = 46,
    r24b = 47,
    r25f = 48,
    r25b = 49,
    r26f = 50,
    r26b = 51,
    r27f = 52,
    r27b = 53,
    r28f = 54,
    r28b = 55,
    r29f = 56,
    r29b = 57,
    r30f = 58,
    r30b = 59,
    r31f = 60,
    r31b = 61,
    r32f = 62,
    r32b = 63,
    r33f = 64,
    r33b = 65,
    r34f = 66,
    r34b = 67,
    r35f = 68,
    r35b = 69,
    r36f = 70,
    r36b = 71,
    r38f = 72,
    r38b = 73,
    r39f = 74,
    r39b = 75,
    r40f = 76,
    r40b = 77,
    r41f = 78,
    r41b = 79,
    r42f = 80,
    r42b = 81,
    r43f = 82,
    r43b = 83,
    r44f = 84,
    r44b = 85,
    r45f = 86,
    r45b = 87,
    r46f = 88,
    r46b = 89,
    r47f = 90,
    r47b = 91,
    r48f = 92,
    r48b = 93,
    r49f = 94,
    r49b = 95,
    r50f = 96,
    r50b = 97,
    r51f = 98,
    r51b = 99,
    r52f = 100,
    r52b = 101,
    r53f = 102,
    r53b = 103,
    r54f = 104,
    r54b = 105,
    r55f = 106,
    r55b = 107,
    r56f = 108,
    r56b = 109,
    r57f = 110,
    r57b = 111,
    r58f = 112,
    r58b = 113,
    r59f = 114,
    r59b = 115,
    r60f = 116,
    r60b = 117,
    r61f = 118,
    r61b = 119,
    r62f = 120,
    r62b = 121,
    r63f = 122,
    r63b = 123,
    r64f = 124,
    r64b = 125,
    r65f = 126,
    r65b = 127,
    r66f = 128,
    r66b = 129,
    r67f = 130,
    r67b = 131,
    r68f = 132,
    r68b = 133,
    r69f = 134,
    r69b = 135,
    r70f = 136,
    r70b = 137,
    r71f = 138,
    r71b = 139,
    r72f = 140,
    r72b = 141,
    r73f = 142,
    r73b = 143,
    r74f = 144,
    r74b = 145,
    r75f = 146,
    r75b = 147,
    r76f = 148,
    r76b = 149,
    r77f = 150,
    r77b = 151,
    r78f = 152,
    r78b = 153,
    r79f = 154,
    r79b = 155,
    r80f = 156,
    r80b = 157,
    r81f = 158,
    r81b = 159,
    r82f = 160,
    r82b = 161,
    r83f = 162,
    r83b = 163,
    r84f = 164,
    r84b = 165,
    r85f = 166,
    r85b = 167,
    r86f = 168,
    r86b = 169,
    r87f = 170,
    r87b = 171,
    r88f = 172,
    r88b = 173,
    r89f = 174,
    r89b = 175,
    r90f = 176,
    r90b = 177,
    r91f = 178,
    r91b = 179,
    r92f = 180,
    r92b = 181,
    r93f = 182,
    r93b = 183,
    r94f = 184,
    r94b = 185,
    r95f = 186,
    r95b = 187,
    r96f = 188,
    r96b = 189,
    r97f = 190,
    r97b = 191,
    r98f = 192,
    r98b = 193,
    r99f = 194,
    r99b = 195,
    r100f = 196,
    r100b = 197,
    r101f = 198,
    r101b = 199,
    r102f = 200,
    r102b = 201,
    r103f = 202,
    r103b = 203,
    r104f = 204,
    r104b = 205,
    r105f = 206,
    r105b = 207,
    r106f = 208,
    r106b = 209,
    r107f = 210,
    r107b = 211,
    r108f = 212,
    r108b = 213,
    r109f = 214,
    r109b = 215,
    r110f = 216,
    r110b = 217,
    r111f = 218,
    r111b = 219,
    r112f = 220,
    r112b = 221,
    r113f = 222,
    r113b = 223,
    r114f = 224,
    r114b = 225,
    r115f = 226,
    r115b = 227,
    r116f = 228,
    r116b = 229,
    r117f = 230,
    r117b = 231,
    r118f = 232,
    r118b = 233,
    r119f = 234,
    r119b = 235,
    r120f = 236,
    r120b = 237,
    r121f = 238,
    r121b = 239,
    r122f = 240,
    r122b = 241,
    r123f = 242,
    r123b = 243,
    r124f = 244,
    r124b = 245,
    r125f = 246,
    r125b = 247,
    r126f = 248,
    r126b = 249,
    r127f = 250,
    r127b = 251,
    r128f = 252,
    r128b = 253,
    r129f = 254,
    r129b = 255,
    r130f = 256,
    r130b = 257,
    r131f = 258,
    r131b = 259,
    r132f = 260,
    r132b = 261,
    r133f = 262,
    r133b = 263,
    r134f = 264,
    r134b = 265,
    r135 = 266,
    r136f = 267,
    r136b = 268,
    r137f = 269,
    r137b = 270,
    r138f = 271,
    r138b = 272,
    r139f = 273,
    r139b = 274,
    r140f = 275,
    r140b = 276,
    r141f = 277,
    r141b = 278,
    r142f = 279,
    r142b = 280,
    r144f = 281,
    r144b = 282,
    r145f = 283,
    r145b = 284,
    r146f = 285,
    r146b = 286,
    r147f = 287,
    r147b = 288,
    r148f = 289,
    r148b = 290,
    r149f = 291,
    r149b = 292,
    r150f = 293,
    r150b = 294,
    r151f = 295,
    r151b = 296,
    r152f = 297,
    r152b = 298,
    r153f = 299,
    r153b = 300,
    r154f = 301,
    r154b = 302,
    r155f = 303,
    r155b = 304,
    r156f = 305,
    r156b = 306,
    r157f = 307,
    r157b = 308,
    r158f = 309,
    r158b = 310,
    r159f = 311,
    r159b = 312,
    r160f = 313,
    r160b = 314,
    r161f = 315,
    r161b = 316,
    r162f = 317,
    r162b = 318,
    r163f = 319,
    r163b = 320,
    r164f = 321,
    r164b = 322,
    r165f = 323,
    r165b = 324,
    r166f = 325,
    r166b = 326,
    r167f = 327,
    r167b = 328,
    r168f = 329,
    r168b = 330,
    r169f = 331,
    r169b = 332,
    r170f = 333,
    r170b = 334,
    r171f = 335,
    r171b = 336,
    r172f = 337,
    r172b = 338,
    r173f = 339,
    r173b = 340,
    r174f = 341,
    r174b = 342,
    r175f = 343,
    r175b = 344,
    r176f = 345,
    r176b = 346,
    r177f = 347,
    r177b = 348,
    r178f = 349,
    r178b = 350,
    r179f = 351,
    r179b = 352,
    r180f = 353,
    r180b = 354,
    r181f = 355,
    r181b = 356,
    r182f = 357,
    r182b = 358,
    r183f = 359,
    r183b = 360,
    r184f = 361,
    r184b = 362,
    r185f = 363,
    r185b = 364,
    r186f = 365,
    r186b = 366,
    r187f = 367,
    r187b = 368,
    r188f = 369,
    r188b = 370,
    r189f = 371,
    r189b = 372,
    r190f = 373,
    r190b = 374,
    r191f = 375,
    r191b = 376,
    r192f = 377,
    r192b = 378,
    r193f = 379,
    r193b = 380,
    r194f = 381,
    r194b = 382,
    r195f = 383,
    r195b = 384,
    r196f = 385,
    r196b = 386,
    r197f = 387,
    r197b = 388,
    r198f = 389,
    r198b = 390,
    r199f = 391,
    r199b = 392,
    r200f = 393,
    r200b = 394,
    r201f = 395,
    r201b = 396,
    r202f = 397,
    r202b = 398,
    r203f = 399,
    r203b = 400,
    r204f = 401,
    r204b = 402,
    r205f = 403,
    r205b = 404,
    r206f = 405,
    r206b = 406,
    r207f = 407,
    r207b = 408,
    r208f = 409,
    r208b = 410,
    r209f = 411,
    r209b = 412,
    r210f = 413,
    r210b = 414,
    r211f = 415,
    r211b = 416,
    r212f = 417,
    r212b = 418,
    r213f = 419,
    r213b = 420,
    r214f = 421,
    r214b = 422,
    r215f = 423,
    r215b = 424,
    r216f = 425,
    r216b = 426,
    r217f = 427,
    r217b = 428,
    r218f = 429,
    r218b = 430,
    r219f = 431,
    r219b = 432,
    r220f = 433,
    r220b = 434,
    r221f = 435,
    r221b = 436,
    r222f = 437,
    r222b = 438,
    r223f = 439,
    r223b = 440,
    r224f = 441,
    r224b = 442,
    r225f = 443,
    r225b = 444,
    r226f = 445,
    r226b = 446,
    r227f = 447,
    r227b = 448,
    r228f = 449,
    r228b = 450,
    r229f = 451,
    r229b = 452,
    r230f = 453,
    r230b = 454,
    r231f = 455,
    r231b = 456,
    r232f = 457,
    r232b = 458,
    r233f = 459,
    r233b = 460,
    r234f = 461,
    r234b = 462,
    r235 = 463,
    r236f = 464,
    r236b = 465,
    r237f = 466,
    r237b = 467,
    r238f = 468,
    r238b = 469,
    r239f = 470,
    r239b = 471,
    r240f = 472,
    r240b = 473,
    r241f = 474,
    r241b = 475,
    r242f = 476,
    r242b = 477,
    r243f = 478,
    r243b = 479,
    r244f = 480,
    r244b = 481,
    r245f = 482,
    r245b = 483,
    r246f = 484,
    r246b = 485,
    r247f = 486,
    r247b = 487,
    r248f = 488,
    r248b = 489,
    r249f = 490,
    r249b = 491,
    r250f = 492,
    r250b = 493,
    r251f = 494,
    r251b = 495,
    r252f = 496,
    r252b = 497,
    r253f = 498,
    r253b = 499,
    r254f = 500,
    r254b = 501,
    r255f = 502,
    r255b = 503,
    r256f = 504,
    r256b = 505,
    r257f = 506,
    r257b = 507,
    r258f = 508,
    r258b = 509,
    r259f = 510,
    r259b = 511,
    r260f = 512,
    r260b = 513,
    r261f = 514,
    r261b = 515,
    r262f = 516,
    r262b = 517,
    r263f = 518,
    r263b = 519,
    r264f = 520,
    r264b = 521,
    r265f = 522,
    r265b = 523,
    r266f = 524,
    r266b = 525,
    r267f = 526,
    r267b = 527,
    r268f = 528,
    r268b = 529,
    r269f = 530,
    r269b = 531,
    r270f = 532,
    r270b = 533,
    r271f = 534,
    r271b = 535,
    r272f = 536,
    r272b = 537,
    r273 = 538,
    r274f = 539,
    r274b = 540,
    r275f = 541,
    r275b = 542,
    r276f = 543,
    r276b = 544,
    r277f = 545,
    r277b = 546,
    r278f = 547,
    r278b = 548,
    r279f = 549,
    r279b = 550,
    r280f = 551,
    r280b = 552,
    r281f = 553,
    r281b = 554,
    r282f = 555,
    r282b = 556,
    r283f = 557,
    r283b = 558,
    r284 = 559,
    r285f = 560,
    r285b = 561,
    r286f = 562,
    r286b = 563,
    r287f = 564,
    r287b = 565,
    r288 = 566,
    r289f = 567,
    r289b = 568,
    r290 = 569,
    r291f = 570,
    r291b = 571,
    r292 = 572,
    r293 = 573,
    r294f = 574,
    r294b = 575,
    r295f = 576,
    r295b = 577,
    r296f = 578,
    r296b = 579,
    r297 = 580,
    r298 = 581,
    r299f = 582,
    r299b = 583,
    r300 = 584,
    r301 = 585,
    r302 = 586,
    r303 = 587,
    r304f = 588,
    r304b = 589,
    r305 = 590,
    r306 = 591,
    r307 = 592,
    r308f = 593,
    r308b = 594,
    r309f = 595,
    r309b = 596,
    r310f = 597,
    r310b = 598,
    r311f = 599,
    r311b = 600,
    r312f = 601,
    r312b = 602,
    r313f = 603,
    r313b = 604,
    r314f = 605,
    r314b = 606,
    r315f = 607,
    r315b = 608,
    r316 = 609,
    r317f = 610,
    r317b = 611,
    r318f = 612,
    r318b = 613,
    r319f = 614,
    r319b = 615,
    r320f = 616,
    r320b = 617,
    r321f = 618,
    r321b = 619,
    r322f = 620,
    r322b = 621,
    r323f = 622,
    r323b = 623,
    r324 = 624,
    r325f = 625,
    r325b = 626,
    /* PAHReactions */
    /* SootReactions */
    rEnd
  } ReactionLabel;

  typedef enum ThirdBodyLabel {

    mM1 = 0,
    mM2 = 1,
    mM3 = 2,
    mM4 = 3,
    mM5 = 4,
    mM6 = 5,
    mEnd
  } ThirdBodyLabel;

  void ComputeProductionRates(span<double> cdot, span<double> w, span<double> k,
                              span<double> c, span<double> M, double temp,
                              double pressure) const override;

  virtual void ComputeThermoData(span<double> h, span<double> cp, double T,
                                 span<double> s) const override;

  int getNSpecies() const override { return sEnd; }

  int getNSpecs() const override { return sEnd; }

  int getNReactions() const override { return rEnd; }

  void getMolarMass(span<double> W) const override {
    FUB_ASSERT(W.size() == getNSpecies());
    W[sAR] = 0x1.3f95810624dd3p+5;
    W[sO] = 0x1p+4;
    W[sO2] = 0x1p+5;
    W[sH] = 0x1.020c49ba5e354p+0;
    W[sOH] = 0x1.1020c49ba5e35p+4;
    W[sH2] = 0x1.020c49ba5e354p+1;
    W[sHO2] = 0x1.0810624dd2f1bp+5;
    W[sH2O2] = 0x1.1020c49ba5e35p+5;
    W[sCH] = 0x1.a09374bc6a7fp+3;
    W[sCO] = 0x1.c028f5c28f5c2p+4;
    W[s3XCH2] = 0x1.c0d4fdf3b645ap+3;
    W[sHCO] = 0x1.d049ba5e353f8p+4;
    W[s1XCH2] = 0x1.c0d4fdf3b645ap+3;
    W[sCH3] = 0x1.e116872b020c4p+3;
    W[sCH2O] = 0x1.e06a7ef9db22cp+4;
    W[sCH4] = 0x1.00ac083126e98p+4;
    W[sCO2] = 0x1.60147ae147ae1p+5;
    W[sCH2OH] = 0x1.f08b439581062p+4;
    W[sCH3O] = 0x1.f08b439581062p+4;
    W[sCH3OH] = 0x1.005604189374cp+5;
    W[sC2H] = 0x1.9072b020c49bap+4;
    W[sC2H2] = 0x1.a09374bc6a7fp+4;
    W[sHCCO] = 0x1.48395810624ddp+5;
    W[sC2H3] = 0x1.b0b4395810625p+4;
    W[sCH2CO] = 0x1.5049ba5e353f8p+5;
    W[sC2H4] = 0x1.c0d4fdf3b645ap+4;
    W[sC2H5] = 0x1.d0f5c28f5c28fp+4;
    W[sC2H6] = 0x1.e116872b020c4p+4;
    W[sH2O] = 0x1.204189374bc6ap+4;
    W[sN2] = 0x1.c051eb851eb85p+4;
    W[sC] = 0x1.8051eb851eb85p+3;
    W[sHCCOH] = 0x1.5049ba5e353f8p+5;
    W[sN] = 0x1.c051eb851eb85p+3;
    W[sNO] = 0x1.e028f5c28f5c2p+4;
    W[sN2O] = 0x1.6028f5c28f5c2p+5;
    W[sNO2] = 0x1.70147ae147ae1p+5;
    W[sNH] = 0x1.e09374bc6a7fp+3;
    W[sHNO] = 0x1.f049ba5e353f8p+4;
    W[sNH2] = 0x1.006a7ef9db22dp+4;
    W[sNNH] = 0x1.d072b020c49bap+4;
    W[sCN] = 0x1.a051eb851eb85p+4;
    W[sNCO] = 0x1.5028f5c28f5c2p+5;
    W[sHCN] = 0x1.b072b020c49bap+4;
    W[sHOCN] = 0x1.58395810624ddp+5;
    W[sHNCO] = 0x1.58395810624ddp+5;
    W[sH2CN] = 0x1.c09374bc6a7fp+4;
    W[sHCNN] = 0x1.484dd2f1a9fbep+5;
    W[sHCNO] = 0x1.58395810624ddp+5;
    W[sNH3] = 0x1.108b439581062p+4;
    W[sCH2CHO] = 0x1.585a1cac08312p+5;
    W[sCH3CHO] = 0x1.606a7ef9db22dp+5;
    W[sC3H8] = 0x1.60c083126e979p+5;
    W[sC3H7] = 0x1.58b020c49ba5ep+5;
  }

  std::vector<std::string> getSpeciesNames() const override {
    return std::vector<std::string>{
        "AR",    "O ",     "O2",     "H ",    "OH",    "H2",   "HO2 ", "H2O2",
        "CH",    "CO",     "3-CH2",  "HCO",   "1-CH2", "CH3",  "CH2O", "CH4",
        "CO2",   "CH2OH",  "CH3O",   "CH3OH", "C2H",   "C2H2", "HCCO", "C2H3",
        "CH2CO", "C2H4",   "C2H5",   "C2H6",  "H2O",   "N2",   "C",    "HCCOH",
        "N",     "NO",     "N2O",    "NO2",   "NH",    "HNO",  "NH2",  "NNH",
        "CN",    "NCO",    "HCN",    "HOCN",  "HNCO",  "H2CN", "HCNN", "HCNO",
        "NH3",   "CH2CHO", "CH3CHO", "C3H8",  "C3H7"};
  }

  int getNThirdBodyReactions() const override { return mEnd; }

  std::unique_ptr<FlameMasterMechanism> Clone() const override {
    return std::make_unique<Gri30>();
  }
};

} // namespace ideal_gas
} // namespace fub

#endif
